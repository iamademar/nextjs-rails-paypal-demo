{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["file:///home/ademar/rails-nextjs-paypal-demo/subscription-frontend/app/hooks/useApi.ts"],"sourcesContent":["// Hook for making API calls\r\nimport { useState, useCallback } from \"react\";\r\n\r\ntype ApiMethod = \"GET\" | \"POST\" | \"PUT\" | \"DELETE\";\r\n\r\ninterface ApiOptions {\r\n  method?: ApiMethod;\r\n  body?: object;\r\n  headers?: Record<string, string>;\r\n}\r\n\r\ninterface ApiState<T> {\r\n  data: T | null;\r\n  loading: boolean;\r\n  error: string | null;\r\n}\r\n\r\nconst BASE_URL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:3001/api\";\r\n\r\nexport function useApi<T>() {\r\n  const [state, setState] = useState<ApiState<T>>({\r\n    data: null,\r\n    loading: false,\r\n    error: null,\r\n  });\r\n\r\n  const request = useCallback(\r\n    async (endpoint: string, options: ApiOptions = {}) => {\r\n      const { method = \"GET\", body, headers = {} } = options;\r\n\r\n      // Set some default headers\r\n      const defaultHeaders = {\r\n        \"Content-Type\": \"application/json\",\r\n        Accept: \"application/json\",\r\n      };\r\n\r\n      // Set loading state\r\n      setState((prevState) => ({ ...prevState, loading: true, error: null }));\r\n\r\n      try {\r\n        // Make the request\r\n        const response = await fetch(`${BASE_URL}${endpoint}`, {\r\n          method,\r\n          headers: { ...defaultHeaders, ...headers },\r\n          body: body ? JSON.stringify(body) : undefined,\r\n        });\r\n\r\n        // Check if the response is ok\r\n        if (!response.ok) {\r\n          // Try to get error details from the response if available\r\n          let errorMessage = `Request failed with status ${response.status}`;\r\n          try {\r\n            const errorData = await response.json();\r\n            errorMessage = errorData.error || errorMessage;\r\n          } catch {\r\n            // If we can't parse the error response, just use the default message\r\n          }\r\n          throw new Error(errorMessage);\r\n        }\r\n\r\n        // Parse the response\r\n        const data = await response.json();\r\n\r\n        // Update the state with the data\r\n        setState({\r\n          data,\r\n          loading: false,\r\n          error: null,\r\n        });\r\n\r\n        return data;\r\n      } catch (error) {\r\n        // Update the state with the error\r\n        setState({\r\n          data: null,\r\n          loading: false,\r\n          error: error instanceof Error ? error.message : \"Unknown error\",\r\n        });\r\n        throw error;\r\n      }\r\n    },\r\n    []\r\n  );\r\n\r\n  return {\r\n    ...state,\r\n    request,\r\n  };\r\n}\r\n\r\nexport default useApi;\r\n"],"names":[],"mappings":"AAAA,4BAA4B;;;;;AAC5B;;AAgBA,MAAM,WAAW,iEAAmC;AAE7C,SAAS;IACd,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAe;QAC9C,MAAM;QACN,SAAS;QACT,OAAO;IACT;IAEA,MAAM,UAAU,CAAA,GAAA,qMAAA,CAAA,cAAW,AAAD,EACxB,OAAO,UAAkB,UAAsB,CAAC,CAAC;QAC/C,MAAM,EAAE,SAAS,KAAK,EAAE,IAAI,EAAE,UAAU,CAAC,CAAC,EAAE,GAAG;QAE/C,2BAA2B;QAC3B,MAAM,iBAAiB;YACrB,gBAAgB;YAChB,QAAQ;QACV;QAEA,oBAAoB;QACpB,SAAS,CAAC,YAAc,CAAC;gBAAE,GAAG,SAAS;gBAAE,SAAS;gBAAM,OAAO;YAAK,CAAC;QAErE,IAAI;YACF,mBAAmB;YACnB,MAAM,WAAW,MAAM,MAAM,GAAG,WAAW,UAAU,EAAE;gBACrD;gBACA,SAAS;oBAAE,GAAG,cAAc;oBAAE,GAAG,OAAO;gBAAC;gBACzC,MAAM,OAAO,KAAK,SAAS,CAAC,QAAQ;YACtC;YAEA,8BAA8B;YAC9B,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,0DAA0D;gBAC1D,IAAI,eAAe,CAAC,2BAA2B,EAAE,SAAS,MAAM,EAAE;gBAClE,IAAI;oBACF,MAAM,YAAY,MAAM,SAAS,IAAI;oBACrC,eAAe,UAAU,KAAK,IAAI;gBACpC,EAAE,OAAM;gBACN,qEAAqE;gBACvE;gBACA,MAAM,IAAI,MAAM;YAClB;YAEA,qBAAqB;YACrB,MAAM,OAAO,MAAM,SAAS,IAAI;YAEhC,iCAAiC;YACjC,SAAS;gBACP;gBACA,SAAS;gBACT,OAAO;YACT;YAEA,OAAO;QACT,EAAE,OAAO,OAAO;YACd,kCAAkC;YAClC,SAAS;gBACP,MAAM;gBACN,SAAS;gBACT,OAAO,iBAAiB,QAAQ,MAAM,OAAO,GAAG;YAClD;YACA,MAAM;QACR;IACF,GACA,EAAE;IAGJ,OAAO;QACL,GAAG,KAAK;QACR;IACF;AACF;uCAEe","debugId":null}},
    {"offset": {"line": 89, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 95, "column": 0}, "map": {"version":3,"sources":["file:///home/ademar/rails-nextjs-paypal-demo/subscription-frontend/app/%28private%29/billing/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport useApi from \"../../hooks/useApi\";\r\n\r\n// Define the Payment interface\r\ninterface Payment {\r\n  id: string;\r\n  payment_date: string;\r\n  amount: number;\r\n  status: string;\r\n  receipt_id: string | null;\r\n  subscription: {\r\n    description: string;\r\n  };\r\n}\r\n\r\nexport default function BillingPage() {\r\n  const api = useApi();\r\n  const [payments, setPayments] = useState<Payment[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  // Add a flag to track whether we've already fetched data\r\n  const [paymentsFetched, setPaymentsFetched] = useState(false);\r\n\r\n  // Add a handler function for downloading receipts with proper type annotation\r\n  const handleDownload = (receiptId: string) => {\r\n    if (receiptId) {\r\n      // This will construct the URL correctly with BASE_URL from your useApi hook\r\n      window.location.href = `${\r\n        process.env.NEXT_PUBLIC_API_URL || \"http://localhost:3001/api\"\r\n      }/receipts/${receiptId}/download`;\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const fetchPayments = async () => {\r\n      // Avoid duplicate fetches\r\n      if (paymentsFetched) return;\r\n\r\n      try {\r\n        setLoading(true);\r\n        const response = await api.request(\"/payments\");\r\n        setPayments(response);\r\n        setPaymentsFetched(true); // Mark that we've fetched payments\r\n      } catch (err) {\r\n        console.error(\"Error fetching payments:\", err);\r\n        setError(\"Failed to load payment history\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchPayments();\r\n  }, [api]); // Remove paymentsFetched from dependency array\r\n\r\n  if (loading) return <div className=\"p-4\">Loading payment history...</div>;\r\n  if (error) return <div className=\"p-4 text-red-600\">{error}</div>;\r\n\r\n  return (\r\n    <div className=\"container mx-auto p-4\">\r\n      <h1 className=\"text-2xl font-bold mb-6\">Billing & Payment History</h1>\r\n\r\n      {payments.length === 0 ? (\r\n        <div className=\"bg-white p-6 rounded-lg shadow-sm border border-gray-200\">\r\n          <p>No payment history available.</p>\r\n        </div>\r\n      ) : (\r\n        <div className=\"bg-white p-6 rounded-lg shadow-sm border border-gray-200 overflow-x-auto\">\r\n          <table className=\"min-w-full\">\r\n            <thead>\r\n              <tr className=\"text-left text-gray-700\">\r\n                <th className=\"px-4 py-2\">Date</th>\r\n                <th className=\"px-4 py-2\">Description</th>\r\n                <th className=\"px-4 py-2\">Amount</th>\r\n                <th className=\"px-4 py-2\">Status</th>\r\n                <th className=\"px-4 py-2\">Receipt</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {payments.map((payment) => (\r\n                <tr key={payment.id} className=\"border-t\">\r\n                  <td className=\"px-4 py-2\">\r\n                    {new Date(payment.payment_date).toLocaleDateString()}\r\n                  </td>\r\n                  <td className=\"px-4 py-2\">\r\n                    {payment.subscription.description}\r\n                  </td>\r\n                  <td className=\"px-4 py-2\">${payment.amount}</td>\r\n                  <td className=\"px-4 py-2\">\r\n                    <span\r\n                      className={`px-2 py-1 rounded-full text-xs ${\r\n                        payment.status === \"COMPLETED\"\r\n                          ? \"bg-green-100 text-green-800\"\r\n                          : payment.status === \"PENDING\"\r\n                          ? \"bg-yellow-100 text-yellow-800\"\r\n                          : \"bg-red-100 text-red-800\"\r\n                      }`}\r\n                    >\r\n                      {payment.status}\r\n                    </span>\r\n                  </td>\r\n                  <td className=\"px-4 py-2\">\r\n                    {payment.receipt_id ? (\r\n                      <div className=\"flex space-x-2\">\r\n                        <button\r\n                          onClick={() =>\r\n                            handleDownload(payment.receipt_id as string)\r\n                          }\r\n                          className=\"text-green-600 hover:underline\"\r\n                        >\r\n                          Download\r\n                        </button>\r\n                      </div>\r\n                    ) : (\r\n                      <span className=\"text-gray-500\">Processing...</span>\r\n                    )}\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;;AAiBe,SAAS;IACtB,MAAM,MAAM,CAAA,GAAA,sHAAA,CAAA,UAAM,AAAD;IACjB,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAa,EAAE;IACtD,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAiB;IAElD,yDAAyD;IACzD,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAEvD,8EAA8E;IAC9E,MAAM,iBAAiB,CAAC;QACtB,IAAI,WAAW;YACb,4EAA4E;YAC5E,OAAO,QAAQ,CAAC,IAAI,GAAG,GACrB,iEAAmC,4BACpC,UAAU,EAAE,UAAU,SAAS,CAAC;QACnC;IACF;IAEA,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,gBAAgB;YACpB,0BAA0B;YAC1B,IAAI,iBAAiB;YAErB,IAAI;gBACF,WAAW;gBACX,MAAM,WAAW,MAAM,IAAI,OAAO,CAAC;gBACnC,YAAY;gBACZ,mBAAmB,OAAO,mCAAmC;YAC/D,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,4BAA4B;gBAC1C,SAAS;YACX,SAAU;gBACR,WAAW;YACb;QACF;QAEA;IACF,GAAG;QAAC;KAAI,GAAG,+CAA+C;IAE1D,IAAI,SAAS,qBAAO,8OAAC;QAAI,WAAU;kBAAM;;;;;;IACzC,IAAI,OAAO,qBAAO,8OAAC;QAAI,WAAU;kBAAoB;;;;;;IAErD,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAG,WAAU;0BAA0B;;;;;;YAEvC,SAAS,MAAM,KAAK,kBACnB,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;8BAAE;;;;;;;;;;qCAGL,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAM,WAAU;;sCACf,8OAAC;sCACC,cAAA,8OAAC;gCAAG,WAAU;;kDACZ,8OAAC;wCAAG,WAAU;kDAAY;;;;;;kDAC1B,8OAAC;wCAAG,WAAU;kDAAY;;;;;;kDAC1B,8OAAC;wCAAG,WAAU;kDAAY;;;;;;kDAC1B,8OAAC;wCAAG,WAAU;kDAAY;;;;;;kDAC1B,8OAAC;wCAAG,WAAU;kDAAY;;;;;;;;;;;;;;;;;sCAG9B,8OAAC;sCACE,SAAS,GAAG,CAAC,CAAC,wBACb,8OAAC;oCAAoB,WAAU;;sDAC7B,8OAAC;4CAAG,WAAU;sDACX,IAAI,KAAK,QAAQ,YAAY,EAAE,kBAAkB;;;;;;sDAEpD,8OAAC;4CAAG,WAAU;sDACX,QAAQ,YAAY,CAAC,WAAW;;;;;;sDAEnC,8OAAC;4CAAG,WAAU;;gDAAY;gDAAE,QAAQ,MAAM;;;;;;;sDAC1C,8OAAC;4CAAG,WAAU;sDACZ,cAAA,8OAAC;gDACC,WAAW,CAAC,+BAA+B,EACzC,QAAQ,MAAM,KAAK,cACf,gCACA,QAAQ,MAAM,KAAK,YACnB,kCACA,2BACJ;0DAED,QAAQ,MAAM;;;;;;;;;;;sDAGnB,8OAAC;4CAAG,WAAU;sDACX,QAAQ,UAAU,iBACjB,8OAAC;gDAAI,WAAU;0DACb,cAAA,8OAAC;oDACC,SAAS,IACP,eAAe,QAAQ,UAAU;oDAEnC,WAAU;8DACX;;;;;;;;;;qEAKH,8OAAC;gDAAK,WAAU;0DAAgB;;;;;;;;;;;;mCAlC7B,QAAQ,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6CnC","debugId":null}},
    {"offset": {"line": 344, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 349, "column": 0}, "map": {"version":3,"sources":["file:///home/ademar/rails-nextjs-paypal-demo/subscription-frontend/node_modules/next/src/server/route-modules/app-page/module.compiled.js"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n    } else if (process.env.TURBOPACK) {\n      module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n    } else {\n      module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n    } else if (process.env.TURBOPACK) {\n      module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n    } else {\n      module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n    }\n  }\n}\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK"],"mappings":";AAAA,IAAIA,QAAQC,GAAG,CAACC,YAAY,KAAK,MAAQ;;AAEzC,OAAO;IACL,IAAIF,QAAQC,GAAG,CAACK,uBAA2B,EAAF;;IAQzC,OAAO;QACL,IAAIN,QAAQC,GAAG,CAACM,QAAQ,KAAK,WAAe;YAC1CJ,OAAOC,OAAO,GAAGC,QAAQ;QAC3B,OAAO,IAAIL,QAAQC,GAAG,CAACO,SAAS,EAAE;;QAIlC;IACF;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 363, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 368, "column": 0}, "map": {"version":3,"sources":["file:///home/ademar/rails-nextjs-paypal-demo/subscription-frontend/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = require('../../module.compiled').vendored[\n  'react-ssr'\n].ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":";AAAAA,OAAOC,OAAO,GAAGC,QAAQ,4HAAyBC,QAAQ,CACxD,YACD,CAACC,kBAAkB","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 370, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 375, "column": 0}, "map": {"version":3,"sources":["file:///home/ademar/rails-nextjs-paypal-demo/subscription-frontend/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts"],"sourcesContent":["module.exports = require('../../module.compiled').vendored['react-ssr'].React\n"],"names":["module","exports","require","vendored","React"],"mappings":";AAAAA,OAAOC,OAAO,GAAGC,QAAQ,4HAAyBC,QAAQ,CAAC,YAAY,CAACC,KAAK","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 377, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}